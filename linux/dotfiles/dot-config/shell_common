# alias and env variables imported in bash and zsh

#####################
### Env Variables ###
#####################

# man colors
export MANPAGER="less -R --use-color -Dd+r -Du+b"
export MANROFFOPT="-P -c"

# bitwarden
export SSH_AUTH_SOCK="$HOME"/.var/app/com.bitwarden.desktop/data/.bitwarden-ssh-agent.sock #"$HOME"/.bitwarden-ssh-agent.sock

# neovim
export EDITOR='nvim'

# ripgrep
export RIPGREP_CONFIG_PATH="$XDG_CONFIG_HOME"/ripgrep/ripgreprc

# libvirt URI for qemu virtual machines
export LIBVIRT_DEFAULT_URI='qemu:///system'

###############
### Aliases ###
###############

# overwrites
alias l='ls -CF'
alias la='ls -A'
alias ll='ls -alF'
alias ls='ls --color=auto'
alias grep='grep --color=auto'
alias ip='ip -color=auto'
alias diff='diff --color=auto'
alias tree='tree -C'

# git
alias gst='git status'

# vim
alias vim='nvim'
alias vi='nvim'
alias vimdiff='nvim -d'
alias vij="nvim -c 'set filetype=json' -"
alias viy="nvim -c 'set filetype=yaml' -"

# bat
alias batj='bat -l json'
alias jbat='batj'

# copy and paste
alias pp='wl-paste -n' # use -n to remove newline
alias pps='_dquote' # paste clipboard content with double quotes
alias pee='pp | tee >(vipe | tpc)' # edit clipboard content
alias pc='wl-copy -n' # use -n to remove newline
alias tpc='tee >(pc)' # print and copy
alias pclc='fc -ln -1 | tpc' # copy the last executed command to clipboard
alias pcc='pclc'

# use clipboard content as parameter to the given command:
# usage:
#   ppx echo
#   ppx echo {}
#   ppx mkdir
#   ppx rm -rf {}
ppx() {
  local clip=$(pp)
  local args=()
  local used_placeholder=false

  for arg in "$@"; do
    if [[ "$arg" == "{}" ]]; then
      args+=("$clip")
      used_placeholder=true
    else
      args+=("$arg")
    fi
  done

  # If no {} was found, append clipboard at the end
  if [[ $used_placeholder == false ]]; then
    args+=("$clip")
  fi

  "${args[@]}"
}

#flatpak
#alias wezterm='flatpak run org.wezfurlong.wezterm'

#docker
alias gitleaks='docker run -v $PWD:/path zricethezav/gitleaks:latest git /path'
alias trufflehog='docker run --rm -it -v "$PWD:/pwd" trufflesecurity/trufflehog:latest' # usage: trufflehog github --repo https://github.com/{owner}/{repo}

_dquote() {
  content=$(pp)
  printf '"%s"' "$content"
}
